---
title: "Your Informative Title Here"
subtitle: "Case Study 2" 
author:
  - name: "Radiah Khan"
  - name: "Catherine Weeks" 
  - name: "Mercer Mercer"
  - name : "Nafisa Mohammad"
date: November 14
format: 
  pdf:
    geometry: 
      - left=1in
      - right=1in
      - top=1in
      - bottom=1in
execute: 
  echo: true
  message: false
  warning: false
---
```{r, include= FALSE}
library(tidyverse)
library(glance)
library(ggplot2)
```
```{r, include=FALSE}
library(Sleuth2)
wages <- Sleuth2::ex1029
wages
```
```{r, include=FALSE}
#no na values
sum(is.na(wages))
colSums(is.na(wages))
```
```{r, include=FALSE} 
#EDA Potential 
# - (Wage and Race)
# - (Wage by regions)
# Have a combined plot on that if needed for the research question
#Need input on the EDA
```
```{r, include=FALSE}
# Wrangling the data
#Average wage in each regions by race
wages_region_avg_wage <- wages |>
  select(Wage, Black, Region) |>
  group_by(Region, Black) |>
  summarise(avg_wage_region = mean(Wage, na.rm = TRUE))|>
  ungroup()
wages_region_avg_wage
```
```{r, include=FALSE}
#Just has the experience group
wages_exp_group <- wages |>
  mutate(exp_group = case_when(
    Experience < 21 ~ "0–20",
    Experience < 41 ~ "20–40",
    Experience < 61 ~ "41-60",
  
    TRUE     ~ "60+"
  ))
wages_exp_group
  
```
```{r, include=FALSE}
#Exp group + region
wages_exp_group_region <- wages_exp_group |>
  mutate(Race = ifelse(Black == "Yes", "Black", "Non-Black")) |>
  group_by(Region, Race, exp_group) |>
  summarise(avg_wage = mean(Wage, na.rm = TRUE), .groups = "drop")

  

```

```{r, echo= FALSE}
#Plotting EDA (Exp group and avg wage by race)
#The region plot looks really condensed 
ggplot(wages_exp_group_region, 
       aes(x = exp_group, y = avg_wage, fill = Race)) +
  geom_col(position = position_dodge(width = 0.7)) +
  facet_wrap(~ Region) +
  labs(title = "Average Wage by Experience Group among Races",
       x = "Experience Group (years)",
       y = "Average Wage") +
  coord_flip() +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))


```


```{r}
#MLM model 
mlm_model <- lm(Wage ~ Education + Black + Experience + Region, data = wages)
summary(mlm_model)
```

