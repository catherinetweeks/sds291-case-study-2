---
title: "Your Informative Title Here"
subtitle: "Case Study 2" 
author:
  - name: "Radiah Khan"
  - name: "Catherine Weeks" 
  - name: "Mercer Mercer"
  - name : "Nafisa Mohammad"
date: November 14
format: 
  pdf:
    geometry: 
      - left=1in
      - right=1in
      - top=1in
      - bottom=1in
execute: 
  echo: true
  message: false
  warning: false
---
```{r}
library(tidyverse)
#library(glance)
library(ggplot2)
```
```{r, include=FALSE}
library(Sleuth2)
wages <- Sleuth2::ex1029
wages
```
```{r}
#no na values
sum(is.na(wages))
colSums(is.na(wages))
```
```{r} 
#EDA Potential 
# - (Wage and Race)
# - (Wage by regions)
# Have a combined plot on that if needed for the research question
#Need input on the EDA
```
```{r}
# Wrangling the data
#Average wage in each regions by race
wages_region_avg_wage <- wages |>
  select(Wage, Black, Region) |>
  group_by(Region, Black) |>
  summarise(avg_wage_region = mean(Wage, na.rm = TRUE))|>
  ungroup()
wages_region_avg_wage
```
```{r}
#Just has the experience group
wages_exp_group <- wages |>
  mutate(exp_group = case_when(
    Experience < 11 ~ "0–10",
    Experience < 21 ~ "11–20",
    Experience < 31 ~ "21-30",
    Experience < 41 ~ "31-40",
    Experience < 51 ~ "41-50",
    TRUE     ~ "50+"
  ))
wages_exp_group
  
```
```{r}
#Exp group + region
wages_exp_group_region <- wages_exp_group |>
  group_by(Region, Black, exp_group) |>
  summarise(avg_wage_region = mean(Wage, na.rm = TRUE))|>
  ungroup()
wages_exp_group_region
  
```

```{r}
unique(wages$Experience)

```


```{r}
#MLM model 
mlm_model <- lm(Wage ~ Education + Black + Experience + Region, data = wages)
summary(mlm_model)
```


```{r}
#get averages of education per region
wages_edu_group_region <- wages |>
  group_by(Region, Black) |>
  summarise(avg_education = mean(Education, na.rm = TRUE)) |>
  ungroup()
wages_edu_group_region

```


```{r}
library(RColorBrewer)

ggplot(wages_edu_group_region, aes(x = avg_education, y = Region, fill = Black)) +
  geom_col() +
  facet_wrap(~ Black) +
  labs(
    title = "Average Education by Region and Race, USA",
    x = "Average Education (in Years of Schooling)",
    y = "Region"
  ) +
  scale_fill_brewer(palette = "Set1") + 
  theme_minimal() +
  theme(
    axis.line.y = element_blank(),
    axis.line.x = element_blank(),
    axis.title.x = element_text(face = "bold"),
    axis.title.y = element_text(face = "bold"),
    plot.title = element_text(face = "bold"),
    legend.title = element_text(face = "bold"),
    strip.background = element_blank(),
    strip.text = element_blank()
  ) + coord_flip()
```

